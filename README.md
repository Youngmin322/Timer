Timer README
=============
음악 플레이어 디자인으로 제작한 맥용 타이머 프로그램입니다.

<p align="center">
  <img src="https://github.com/user-attachments/assets/44f86d46-8cd9-4ad9-883a-83d9d83fcdad" alt="Timer GIF">
</p>

## 프로젝트 소개
- **시간 설정**: Picker로 hour, minutes, seconds를 설정할 수 있도록 구현하였습니다.
- **진행률**: 타이머가 실행되면 프로그레스 바가 나타나며, 왼쪽에는 진행 시간, 오른쪽에는 남은 시간이 나타나도록 구현하였습니다.
- **버튼**: 
  - 일시정지 버튼을 누르면 정지/재생  
  - Backward 버튼을 누르면 설정한 시간에서 다시 처음으로 되돌아감  
  - Forward 버튼을 누르면 설정한 시간도 초기화됨  
- **타이머 시간**: HH:MM:SS 형식으로 포맷하며, 타이머 종료까지 5초가 남았을 경우 색깔이 빨간색으로 변하도록 설정하였습니다.
- **타이머 종료**: 타이머가 종료될 경우 비프음이 한번 울리도록 구현하였습니다.
- **레코드 판**: 타이머가 시작될 경우 설정한 시간 동안 한 바퀴를 돌도록 구현하였습니다.

트러블 슈팅
1. 문제 발견
프로그램을 테스트하는 동안 다음과 같은 현상이 매 테스트마다 동일하게 나타나는 것을 확인하였습니다.

1. 타이머가 종료된 후에도 레코드 이미지가 회전된 상태로 남아 있음.
-  예상 동작: 타이머가 끝나면 이미지가 원래 위치(0도)로 돌아와야 함.
-  실제 동작: 타이머가 끝나도 회전된 상태가 유지됨.

2. 타이머를 초기화했을 때 회전이 원래대로 돌아오지 않음.
- backward 버튼을 눌러도 회전이 초기화 되지 않음.
- 예상 동작: 재설정하면 회전이 0도로 돌아와야 함.
- 실제 동작: 회전이 마지막 위치에 그대로 멈춰 있음.

3. 타이머를 다시 시작했을 때 레코드 이미지가 예상보다 빠르게 또는 느리게 회전하는 경우가 발생함
- 이전 타이머 종료 후 다시 시작할 때 회전 애니메이션이 비정상적으로 동작함.
- 예상 동작: 새 타이머가 시작되면 처음 위치에서 일정하게 회전해서 설정한 시간동안 정확히 한바퀴를 회전해야 함.
- 실제 동작: 이전 회전 값이 남아 있어 새 타이머에서도 영향을 미침.

2. 원인 분석
해당 문제들을 해결하기 위해 코드의 동작을 분석하면서 원인을 정리함.
핵심 원인:
- rotation값이 초기화되지 않아서 새 타이머에도 이전 회전 상태가 유지됨.
- isPlaying이 false로 변경될 때 애니메이션이 자동으로 멈추지 않음.
- 애니메이션의 종료 상태를 명확히 정의하지 않아서 재설정(reset)시에도 마지막 회전 상태가 유지됨.

3. 해결 접근 방법
- 접근 1: rotation을 0으로 초기화하는 로직 추가
  - 타이머가 종료되거나 초기화될 때 rotation = 0으로 설정하면 회전 애니메이션이 정상적으로 초기화될 것이라 가정.
  - 기존의 restTimer() 함수에서 rotaiton 값을 초기화하도록 수정.
- 결과: 재설정 버튼을 누르면 rotation이 0으로 초기화되면서 처음 위치로 되돌아감.
- 접근 2: isPlaying이 false가 되면 애니메이션을 초기화하도록 수정
  - isPlaying이 false가 될 때 애니메이션이 자동으로 리셋되지 않는 문제를 해결해야 함.
  - .animation(nil, value: rotaion)을 활용해 애니메이션을 강제로 중지
- 결과: 타이머가 멈추면 애니메이션이 중단됨.
- 접근 3: 타이머 종료 시 회전을 자동으로 0으로 되돌리기
  - 타이머가 종료 시 회전 값을 0으로 초기화하는 로직이 없으므로 timerRemaining == 0이되면 회전을 자동으로 초기화하는 코드 추가.
- 결과: 타이머가 종료되면 rotation이 자동으로 초기화됨.

4. 최종 해결 방법
최동적으로 문제를 해결하기 위해 다음 3가지 수정 사항을 적용함
- 타이머를 리셋할 때 rotation을 0으로 초기화
- 타이머 종료 시 rotation을 0으로 되돌림
- 애니메이션을 멈출 때 기본 애니메이션을 제거

5. 최종 결과
- 타이머가 종료되면 레코드 이미지가 원래 위치로 되돌아옴
- backward 버튼을 누르면 회전이 정상적으로 초기화 됨
- 타이머를 다시 시작했을 때 애니메이션이 정상 동작 함

이 과정을 통해 배운 점
- SwiftUI의 .animation()은 isPlaying이 false가 되더라도 자동으로 애니메이션을 멈추지 않으므로, 명확하게 nil을 설정해야 함
- onReceive에서 상태를 관리할 때, 종료 조건을 세밀하고 명확히 처리해야 함
- 애니메이션의 상태를 초기화하는 과정이 중요하며, 회전 값을 수동으로 조정해야 함
